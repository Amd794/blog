<!doctype html><html lang=zh-cn><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>深入学习和理解Django视图层：处理请求与响应 - cmdragon's Blog</title><meta name=description content=" ## 第一章：Django框架概述 1.1 什么是Django？ Django是一个高级的Python Web框架，它鼓励快速开发和干净、实用的设计。它由Wall Street Journal的程序员在2005年开发，用于他们的新闻网站。自那时起，Django已经成为全球范围内广泛使用的Web框架之一。
"><meta name=author content="cmdragon"><meta name=robots content="index, follow"><link rel=canonical href=https://blog.cmdragon.cn/posts/3476dd0354c04bdd0485e1bbe91ccb1b/><meta property="og:title" content="深入学习和理解Django视图层：处理请求与响应 - cmdragon's Blog"><meta property="og:description" content=" ## 第一章：Django框架概述 1.1 什么是Django？ Django是一个高级的Python Web框架，它鼓励快速开发和干净、实用的设计。它由Wall Street Journal的程序员在2005年开发，用于他们的新闻网站。自那时起，Django已经成为全球范围内广泛使用的Web框架之一。
"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.cmdragon.cn/posts/3476dd0354c04bdd0485e1bbe91ccb1b/"><meta property="og:image" content="https://blog.cmdragon.cn/images/logo/social-card.png"><meta property="og:site_name" content="cmdragon's Blog"><meta property="article:published_time" content="2024-05-04T17:47:55+08:00"><meta property="article:modified_time" content="2024-05-04T17:47:55+08:00"><meta property="article:section" content="后端开发"><meta property="article:tag" content="Django"><meta property="article:tag" content="请求处理"><meta property="article:tag" content="响应生成"><meta property="article:tag" content="模板渲染"><meta property="article:tag" content="表单处理"><meta property="article:tag" content="中间件"><meta property="article:tag" content="异常处理"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="深入学习和理解Django视图层：处理请求与响应 - cmdragon's Blog"><meta name=twitter:description content=" ## 第一章：Django框架概述 1.1 什么是Django？ Django是一个高级的Python Web框架，它鼓励快速开发和干净、实用的设计。它由Wall Street Journal的程序员在2005年开发，用于他们的新闻网站。自那时起，Django已经成为全球范围内广泛使用的Web框架之一。
"><meta name=twitter:image content="https://blog.cmdragon.cn/images/logo/social-card.png"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"深入学习和理解Django视图层：处理请求与响应","datePublished":"2024-05-04T17:47:55\u002b08:00","dateModified":"2024-05-04T17:47:55\u002b08:00","author":{"@type":"Person","name":"cmdragon"},"description":" ## 第一章：Django框架概述 1.1 什么是Django？ Django是一个高级的Python Web框架，它鼓励快速开发和干净、实用的设计。它由Wall Street Journal的程序员在2005年开发，用于他们的新闻网站。自那时起，Django已经成为全球范围内广泛使用的Web框架之一。\n","image":"https:\/\/blog.cmdragon.cn\/images\/logo\/social-card.png","url":"https:\/\/blog.cmdragon.cn\/posts\/3476dd0354c04bdd0485e1bbe91ccb1b\/","publisher":{"@type":"Organization","name":"cmdragon\u0027s Blog","logo":{"@type":"ImageObject","url":"https:\/\/blog.cmdragon.cn\/images\/logo\/small.png"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.cmdragon.cn\/posts\/3476dd0354c04bdd0485e1bbe91ccb1b\/"},"keywords":"后端开发","keywords":"Django, 请求处理, 响应生成, 模板渲染, 表单处理, 中间件, 异常处理","wordCount":"7294"}</script><link rel=preconnect href=https://cdnjs.cloudflare.com><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js as=script><link rel=icon href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/images/logo/small.png><link rel=icon type=image/png sizes=32x32 href=/images/logo/small.png><link rel=icon type=image/svg+xml href=/images/logo/scalable.svg><meta name=theme-color content="#3B82F6"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2874982874195135" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.3.0/mermaid.min.js></script><script>(function(){if(typeof mermaid!="undefined"){window.mermaid=mermaid;const e=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;window.mermaid.initialize({startOnLoad:!0,theme:e?"dark":"default",securityLevel:"loose",flowchart:{curve:"basis",htmlLabels:!0},sequence:{mirrorActors:!1,wrap:!0},themeVariables:{primaryColor:"#3b82f6",primaryTextColor:"#ffffff",primaryBorderColor:e?"#60a5fa":"#2563eb",lineColor:e?"#94a3b8":"#4b5563",secondaryColor:e?"#1e293b":"#f0f9ff",tertiaryColor:e?"#334155":"#f3f4f6"}}),document.addEventListener("DOMContentLoaded",function(){try{typeof window.mermaid.init=="function"&&window.mermaid.init(0[0],document.querySelectorAll(".mermaid"))}catch{}})}})()</script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css><script defer src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.js></script><script defer src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/contrib/auto-render.min.js></script><link rel=stylesheet href=/css/tailwind.min.css><script src=/js/iconify-icon.min.js></script><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"><link rel=stylesheet href=/css/code-highlight.css><link rel=stylesheet href=/css/markdown.css><style>.mermaid{margin:2rem auto;text-align:center;overflow:visible;width:auto;max-width:100%;background-color:#f9fafb;padding:1.5rem .5rem;border-radius:.5rem;box-shadow:0 2px 4px rgba(0,0,0,5%);display:block}.dark .mermaid{background-color:#1e293b;box-shadow:0 2px 4px rgba(0,0,0,.15)}.mermaid svg{display:block !important;max-width:100%;width:auto !important;height:auto !important;font-size:14px;margin:0 auto}.mermaid .node rect,.mermaid .node circle,.mermaid .node ellipse,.mermaid .node polygon,.mermaid .node path{stroke-width:1px}.mermaid .edgePath .path{stroke-width:1.5px}.mermaid .edgeLabel{font-size:.85em;background-color:inherit !important}.mermaid .label text,.mermaid text.label{fill:#374151;font-weight:400}.dark .mermaid .label text,.dark .mermaid text.label{fill:#e5e7eb}@media(max-width:768px){.mermaid{max-width:98%;padding:.8rem .3rem;margin:1.2rem auto}.mermaid svg{font-size:12px}}</style></head><body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen flex flex-col"><div class="flex-grow flex flex-col"><header class="bg-white dark:bg-gray-800 shadow-md sticky top-0 z-30 transition-all duration-300 border-b border-gray-100 dark:border-gray-700"><div class="container mx-auto px-4"><div class="flex justify-between items-center h-16"><div class="flex items-center"><a href=https://blog.cmdragon.cn/ class="flex items-center gap-2 text-xl font-bold text-gray-900 dark:text-white group transition-all duration-300"><div class="h-9 w-9 flex items-center justify-center transition-all duration-300 transform group-hover:scale-105"><img src=/images/logo/small.png alt="cmdragon's Blog Logo" class="h-full w-auto"></div><span class="group-hover:text-primary transition-colors duration-300">cmdragon's Blog</span></a></div><nav class="hidden md:flex space-x-1"><a href=/ class="px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 relative overflow-hidden group text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" aria-label=首页 tabindex=0><span class="relative z-10">首页</span>
<span class="absolute bottom-0 left-0 w-full h-0 bg-gradient-to-r from-blue-500 to-indigo-600 transition-all duration-300 group-hover:h-full opacity-80 -z-0"></span>
<span class="absolute bottom-0 left-0 w-0 h-1 bg-blue-500 transition-all duration-300 group-hover:w-full"></span>
</a><a href=/archives/ class="px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 relative overflow-hidden group text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" aria-label=归档 tabindex=0><span class="relative z-10">归档</span>
<span class="absolute bottom-0 left-0 w-full h-0 bg-gradient-to-r from-blue-500 to-indigo-600 transition-all duration-300 group-hover:h-full opacity-80 -z-0"></span>
<span class="absolute bottom-0 left-0 w-0 h-1 bg-blue-500 transition-all duration-300 group-hover:w-full"></span>
</a><a href=/categories/ class="px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 relative overflow-hidden group text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" aria-label=分类 tabindex=0><span class="relative z-10">分类</span>
<span class="absolute bottom-0 left-0 w-full h-0 bg-gradient-to-r from-blue-500 to-indigo-600 transition-all duration-300 group-hover:h-full opacity-80 -z-0"></span>
<span class="absolute bottom-0 left-0 w-0 h-1 bg-blue-500 transition-all duration-300 group-hover:w-full"></span>
</a><a href=/tags/ class="px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 relative overflow-hidden group text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" aria-label=标签 tabindex=0><span class="relative z-10">标签</span>
<span class="absolute bottom-0 left-0 w-full h-0 bg-gradient-to-r from-blue-500 to-indigo-600 transition-all duration-300 group-hover:h-full opacity-80 -z-0"></span>
<span class="absolute bottom-0 left-0 w-0 h-1 bg-blue-500 transition-all duration-300 group-hover:w-full"></span>
</a><a href=/friends/ class="px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 relative overflow-hidden group text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" aria-label=友链 tabindex=0><span class="relative z-10">友链</span>
<span class="absolute bottom-0 left-0 w-full h-0 bg-gradient-to-r from-blue-500 to-indigo-600 transition-all duration-300 group-hover:h-full opacity-80 -z-0"></span>
<span class="absolute bottom-0 left-0 w-0 h-1 bg-blue-500 transition-all duration-300 group-hover:w-full"></span></a></nav><div class="flex items-center space-x-3"><button class="p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary" aria-label=搜索 tabindex=0 onclick=openSiteSearch()>
<iconify-icon icon=mdi:magnify width=20 height=20></iconify-icon></button>
<button id=theme-toggle class="p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary" aria-label=切换深色模式 tabindex=0>
<iconify-icon icon=mdi:weather-sunny class=dark:hidden width=20 height=20></iconify-icon><iconify-icon icon=mdi:weather-night class="hidden dark:block" width=20 height=20></iconify-icon></button>
<button id=mobile-menu-button class="md:hidden p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary" aria-label=打开菜单 tabindex=0>
<iconify-icon icon=mdi:menu width=20 height=20></iconify-icon></button></div></div><div id=mobile-menu class="md:hidden hidden pb-3"><div class="space-y-2 px-2 pt-2 pb-3 rounded-lg bg-gray-50 dark:bg-gray-700 mt-2 shadow-inner"><a href=/ class="block px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600" aria-label=首页 tabindex=0><div class="flex items-center"><iconify-icon icon=mdi:chevron-right class=mr-2 width=18 height=18></iconify-icon>首页</div></a><a href=/archives/ class="block px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600" aria-label=归档 tabindex=0><div class="flex items-center"><iconify-icon icon=mdi:chevron-right class=mr-2 width=18 height=18></iconify-icon>归档</div></a><a href=/categories/ class="block px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600" aria-label=分类 tabindex=0><div class="flex items-center"><iconify-icon icon=mdi:chevron-right class=mr-2 width=18 height=18></iconify-icon>分类</div></a><a href=/tags/ class="block px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600" aria-label=标签 tabindex=0><div class="flex items-center"><iconify-icon icon=mdi:chevron-right class=mr-2 width=18 height=18></iconify-icon>标签</div></a><a href=/friends/ class="block px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600" aria-label=友链 tabindex=0><div class="flex items-center"><iconify-icon icon=mdi:chevron-right class=mr-2 width=18 height=18></iconify-icon>友链</div></a></div></div></div></header><script>document.getElementById("mobile-menu-button").addEventListener("click",function(){const e=document.getElementById("mobile-menu");e.classList.toggle("hidden")}),document.getElementById("theme-toggle").addEventListener("click",function(){document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))}),window.addEventListener("scroll",function(){const e=document.querySelector("header");window.scrollY>10?e.classList.add("shadow-lg","bg-white/95","backdrop-blur-sm","dark:bg-gray-800/95"):e.classList.remove("shadow-lg","bg-white/95","backdrop-blur-sm","dark:bg-gray-800/95")})</script><main class="container mx-auto px-4 py-8 flex-grow"><div class="container mx-auto px-4 sm:px-6 relative"><div class="flex flex-col lg:flex-row lg:gap-8"><article class="w-full lg:w-3/4 bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 lg:p-8 mb-8 border border-gray-100 dark:border-gray-700"><nav class="text-sm text-gray-600 dark:text-gray-400 mb-4" aria-label=面包屑导航><ol class="flex flex-wrap items-center" itemscope itemtype=https://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://blog.cmdragon.cn/ class="hover:text-primary dark:hover:text-primary-light transition-colors" itemprop=item aria-label=首页><span itemprop=name>首页</span>
</a><meta itemprop=position content="1"></li><li class=mx-2>/</li><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=https://blog.cmdragon.cn/posts class="hover:text-primary dark:hover:text-primary-light transition-colors" itemprop=item aria-label=Posts><span itemprop=name>Posts</span>
</a><meta itemprop=position content="2"></li><li class=mx-2>/</li><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span class="text-gray-800 dark:text-gray-200" itemprop=name title=深入学习和理解Django视图层：处理请求与响应>深入学习和理解Django视图层：处理请求与响应...</span>
<meta itemprop=position content="3"></li></ol></nav><header class="mb-8 border-b border-gray-100 dark:border-gray-700 pb-6"><h1 class="text-3xl md:text-4xl font-bold mb-4 text-gray-900 dark:text-white leading-tight">深入学习和理解Django视图层：处理请求与响应</h1><div class="flex flex-wrap items-center text-sm text-gray-600 dark:text-gray-300 gap-3"><span class="flex items-center bg-gray-200 dark:bg-gray-700 px-3 py-1.5 rounded-full"><iconify-icon icon=mdi:calendar class=mr-1 width=16 height=16></iconify-icon>2024-05-04
</span><span class="flex items-center bg-blue-200 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-3 py-1.5 rounded-full"><iconify-icon icon=mdi:folder class=mr-1 width=16 height=16></iconify-icon><a href=/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91 class="hover:text-blue-700 dark:hover:text-blue-300 transition-colors">后端开发
</a></span><span class="flex items-center bg-purple-200 dark:bg-purple-900 text-purple-800 dark:text-purple-200 px-3 py-1.5 rounded-full"><iconify-icon icon=mdi:clock-outline class=mr-1 width=16 height=16></iconify-icon>36 分钟阅读
</span><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed target=_blank rel="noopener noreferrer" class="flex items-center bg-green-200 dark:bg-green-900 text-green-800 dark:text-green-200 px-3 py-1.5 rounded-full hover:bg-green-300 dark:hover:bg-green-800 transition-colors" aria-label="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 License" tabindex=0><iconify-icon icon=simple-icons:creativecommons width=16 height=16 class=mr-1></iconify-icon><iconify-icon icon=simple-icons:creativecommonsbysa width=16 height=16 class=mr-1></iconify-icon><iconify-icon icon=simple-icons:creativecommonsnc width=16 height=16 class=mr-1></iconify-icon><span>BY-NC-SA 4.0</span></a></div></header><div class="article-content prose dark:prose-invert lg:prose-lg max-w-none mb-8 leading-relaxed"><img src="/images/2024_05_04 17_51_09.png" title="2024_05_04 17_51_09.png" alt="2024_05_04 17_51_09.png">
## 第一章：Django框架概述<h3 id=11-什么是django>1.1 什么是Django？</h3><p>Django是一个高级的Python Web框架，它鼓励快速开发和干净、实用的设计。它由Wall Street
Journal的程序员在2005年开发，用于他们的新闻网站。自那时起，Django已经成为全球范围内广泛使用的Web框架之一。</p><p>Django的核心理念是“快速开发”和“稳健的防御”，它通过以下特点实现这一点：</p><ul><li><strong>快速开发</strong>：Django提供了一套丰富的功能，如内置的admin界面、模板引擎和数据库迁移系统，这些功能可以帮助开发者快速构建复杂的应用程序。</li><li><strong>稳健的防御</strong>：Django内置了许多安全功能，如防止常见Web攻击（如XSS、CSRF、SQL注入等）的防护措施，以及严格的用户权限管理系统。</li></ul><h3 id=12-django的核心组件>1.2 Django的核心组件</h3><p>Django框架由多个紧密集成的组件组成，这些组件协同工作，提供了一个完整的Web应用程序开发环境。以下是Django的核心组件及其作用：</p><ul><li><strong>模型（Models）</strong> ：模型是Django框架的基石，它们代表数据库中的表。通过定义模型，Django自动创建数据库结构，并提供了操作数据库的接口。</li><li><strong>视图（Views）</strong> ：视图是Django处理HTTP请求的逻辑部分。它们接收来自路由器的请求，处理请求，并返回响应。视图负责业务逻辑，并与模型交互以获取数据。</li><li><strong>模板（Templates）</strong> ：模板是用于生成HTML页面的文本文件。它们允许开发者将数据（由视图提供）插入到HTML中，从而创建动态的Web内容。Django提供了一个强大的模板语言，用于在模板中处理数据和逻辑。</li><li><strong>路由器（URL Router）</strong> ：路由器将URL路径映射到Django视图上。它定义了应用程序的结构，并处理用户的URL请求，将其传递给相应的视图进行处理。</li></ul><p>这些组件共同工作，形成了一个强大的体系结构，使Django成为构建复杂Web应用程序的理想选择。在下一章中，我们将深入探讨Django的视图层，了解它是如何处理请求和生成响应的。</p><h2 id=第二章django视图层基础><strong>第二章：Django视图层基础</strong></h2><h3 id=21-视图函数的定义和作用>2.1 视图函数的定义和作用</h3><p>在Django中，视图函数是处理Web应用程序逻辑的关键部分。视图函数负责接收HTTP请求对象，并返回HTTP响应对象。视图函数通常定义在<code>views.py</code>
文件中，可以通过URL路由器映射到特定的URL路径上。</p><p>视图函数的定义通常如下所示：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>from django.http import HttpResponse


def my_view(request):
    # 处理请求逻辑
    return HttpResponse(&#34;Hello, World!&#34;)</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>在上面的例子中，<code>my_view</code>是一个简单的视图函数，它接收一个<code>request</code>
参数，代表HTTP请求对象。在函数内部，可以根据请求对象的内容进行逻辑处理，然后通过<code>HttpResponse</code>对象返回一个HTTP响应。</p><p>视图函数的作用包括但不限于：</p><ul><li>处理用户请求：接收用户的HTTP请求，从请求中获取数据并进行处理。</li><li>生成响应：根据请求处理的结果生成HTTP响应，可以是HTML页面、JSON数据等。</li><li>业务逻辑处理：执行特定的业务逻辑，如数据查询、计算等。</li><li>路由映射：将URL请求映射到对应的视图函数上。</li></ul><h3 id=22-类视图的概念和用法>2.2 类视图的概念和用法</h3><p>除了使用函数来定义视图外，Django还提供了类视图的概念。类视图是基于类的视图，通过继承Django提供的类视图基类，可以更方便地组织视图逻辑。</p><p>使用类视图的示例：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>from django.views import View
from django.http import HttpResponse


class MyView(View):
    def get(self, request):
        # 处理GET请求逻辑
        return HttpResponse(&#34;Hello, World!&#34;)</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>在上面的例子中，<code>MyView</code>是一个简单的类视图，继承自<code>View</code>
类。类视图中，我们可以通过定义类方法来处理不同类型的HTTP请求，如<code>get()</code>方法用于处理GET请求，<code>post()</code>方法用于处理POST请求等。</p><p>类视图的优点包括：</p><ul><li>代码复用：可以通过继承和重写类方法来实现代码复用。</li><li>可读性：类视图将相关的请求处理逻辑组织在一个类中，提高了代码的可读性和可维护性。</li><li>内置功能：Django提供了许多内置的类视图，如<code>ListView</code>、<code>DetailView</code>等，用于快速构建常见的视图功能。</li></ul><p>类视图和函数视图在功能上是等效的，开发者可以根据个人喜好和项目需求选择使用哪种方式来编写视图。</p><h2 id=第三章处理请求><strong>第三章：处理请求</strong></h2><h3 id=31-请求对象的属性和方法>3.1 请求对象的属性和方法</h3><p>在Django中，请求对象（<code>HttpRequest</code>）是一个包含了HTTP请求信息的对象，可以通过视图函数中的<code>request</code>
参数来访问。请求对象包含了许多属性和方法，常用的包括：</p><ul><li><code>request.method</code>：获取请求的HTTP方法，如GET、POST等。</li><li><code>request.GET</code>：包含GET请求参数的字典。</li><li><code>request.POST</code>：包含POST请求参数的字典。</li><li><code>request.FILES</code>：包含文件上传的数据。</li><li><code>request.path</code>：获取请求的路径部分。</li><li><code>request.META</code>：包含请求的元数据，如请求头信息。</li><li><code>request.COOKIES</code>：包含请求中的cookie数据。</li><li><code>request.session</code>：包含与当前会话相关的数据。</li><li><code>request.user</code>：表示当前登录用户的对象。</li></ul><p>除了上述属性外，请求对象还包含其他一些方法和属性，用于获取请求的信息、处理请求数据等。</p><h3 id=32-请求处理流程>3.2 请求处理流程</h3><p>在Django中，请求处理的流程如下：</p><ol><li><strong>中间件处理</strong>：当请求到达Django应用时，会先经过中间件的处理。中间件可以对请求进行预处理、后处理或者拦截请求。常见的中间件包括身份验证、日志记录、跨域处理等。</li><li><strong>URL路由匹配</strong>
：Django会根据项目中定义的URL路由规则，将请求的URL路径映射到对应的视图函数或类视图上。URL路由器会根据URL配置文件（如<code>urls.py</code>
）中的规则进行匹配。</li><li><strong>视图函数调用</strong>：匹配到对应的视图函数后，Django会调用该视图函数来处理请求。视图函数接收请求对象作为参数，根据请求的方法（GET、POST等）和参数进行逻辑处理，最终生成HTTP响应对象。</li><li><strong>HTTP响应返回</strong>：视图函数生成HTTP响应对象后，Django会将该响应返回给客户端，完成请求-响应循环。</li></ol><p>整个请求处理流程中，中间件起到了预处理和后处理的作用，URL路由器负责将请求分发到对应的视图函数，视图函数则处理具体的业务逻辑并生成响应。这样的分层设计使得Django应用具有良好的可扩展性和可维护性。</p><h2 id=第四章生成响应><strong>第四章：生成响应</strong></h2><h3 id=41-响应对象的属性和方法>4.1 响应对象的属性和方法</h3><p>在Django中，响应对象（<code>HttpResponse</code>）用于表示HTTP响应，包含了服务器返回给客户端的信息。常用的响应对象属性和方法包括：</p><ul><li><code>response.status_code</code>：获取响应的HTTP状态码，如200、404等。</li><li><code>response.content</code>：获取响应的内容，通常是字节流或字符串。</li><li><code>response.charset</code>：获取响应内容的字符集。</li><li><code>response.headers</code>：获取响应的头部信息。</li><li><code>response.set_cookie()</code>：设置cookie信息。</li><li><code>response.delete_cookie()</code>：删除cookie信息。</li><li><code>response.write()</code>：向响应内容中写入数据。</li><li><code>response.flush()</code>：刷新响应内容。</li></ul><p>除了上述属性和方法外，响应对象还包含其他一些方法，用于设置响应的内容、状态码、头部信息等。</p><h3 id=42-响应处理流程>4.2 响应处理流程</h3><p>在Django中，响应处理的流程如下：</p><ol><li><strong>视图函数生成响应</strong>：在视图函数中，通过构造<code>HttpResponse</code>对象或其子类（如<code>JsonResponse</code>
）来生成HTTP响应。视图函数可以设置响应的内容、状态码、头部信息等。</li><li><strong>响应传递</strong>：生成的响应对象会被Django传递给中间件，中间件可以对响应进行处理或者添加额外的信息。</li><li><strong>响应返回给客户端</strong>：最终，Django会将响应对象返回给客户端，客户端根据响应的内容和状态码进行处理。常见的响应状态码包括200（OK）、404（Not
Found）、500（Internal Server Error）等。</li></ol><p>视图函数根据业务逻辑生成响应对象，并通过该对象返回给客户端，完成了请求-响应循环。响应处理流程中，视图函数起到了生成响应的作用，而中间件则可以对响应进行进一步处理或者添加额外的信息。这样的设计使得Django应用能够灵活地处理各种请求，并返回相应的响应给客户端。</p><h2 id=第五章模板渲染><strong>第五章：模板渲染</strong></h2><h3 id=51-模板语言基础>5.1 模板语言基础</h3><p>Django模板语言（Django Template Language）是一种用于在HTML模板中插入动态内容的语言。其基础语法包括：</p><ul><li><strong>变量</strong>：使用<code>{{ variable }}</code>语法表示变量，可以在模板中输出变量的值。</li><li><strong>标签</strong>：使用<code>{% tag %}</code>语法表示标签，用于控制模板的逻辑，如for循环、if条件判断等。</li><li><strong>过滤器</strong>：可以在变量输出时使用过滤器，如<code>{{ variable|filter }}</code>，用于对变量进行格式化或处理。</li></ul><p>示例：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;{{ title }}&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Hello, {{ user }}!&lt;/h1&gt;

&lt;ul&gt;
    {% for item in items %}
    &lt;li&gt;{{ item|upper }}&lt;/li&gt;
    {% endfor %}
&lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>在上面的示例中，<code>{{ title }}</code>、<code>{{ user }}</code>是变量，<code>{% for %}</code>是标签，<code>|upper</code>是过滤器。</p><h3 id=52-模板渲染流程>5.2 模板渲染流程</h3><p>模板渲染是将动态数据填充到模板中，生成最终的HTML页面的过程。在Django中，模板渲染的流程如下：</p><ol><li><strong>视图函数准备数据</strong>：在视图函数中，准备需要传递给模板的数据，可以是单个变量、字典、列表等。</li><li><strong>构造上下文</strong>：将数据封装在上下文（Context）对象中，传递给模板引擎。</li><li><strong>加载模板</strong>：模板引擎根据视图函数指定的模板路径，加载对应的模板文件。</li><li><strong>渲染模板</strong>：模板引擎将上下文中的数据填充到模板中，生成最终的HTML页面。</li><li><strong>返回响应</strong>：最终，视图函数将渲染好的HTML页面封装在<code>HttpResponse</code>对象中返回给客户端。</li></ol><p>整个模板渲染流程中，视图函数起到了准备数据和指定模板的作用，模板引擎负责将数据填充到模板中并生成HTML页面，最终将HTML页面返回给客户端。这样的设计使得前端页面与后端数据逻辑分离，提高了代码的可维护性和可复用性。</p><h2 id=第六章表单处理><strong>第六章：表单处理</strong></h2><h3 id=61-表单定义和验证>6.1 表单定义和验证</h3><p>在Django中，定义表单类是通过继承<code>forms.Form</code>或<code>forms.ModelForm</code>来实现的。表单类定义了表单的字段以及相应的验证规则。</p><h4 id=表单类定义示例>表单类定义示例：</h4><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>from django import forms


class MyForm(forms.Form):
    name = forms.CharField(label=&#39;Name&#39;, max_length=100)
    email = forms.EmailField(label=&#39;Email&#39;)
    message = forms.CharField(label=&#39;Message&#39;, widget=forms.Textarea)</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><h4 id=表单验证过程>表单验证过程：</h4><ol><li>在视图函数中实例化表单类：<code>form = MyForm(request.POST)</code></li><li>调用表单的<code>is_valid()</code>方法进行表单数据验证。</li><li>如果表单数据有效，可以通过<code>form.cleaned_data</code>获取经过清洗后的数据。</li><li>如果表单数据无效，可以通过<code>form.errors</code>获取错误信息，将错误信息传递给模板以便显示给用户。</li></ol><h3 id=62-表单渲染和处理>6.2 表单渲染和处理</h3><h4 id=表单渲染>表单渲染：</h4><ol><li>在模板中使用<code>{{ form.as_p }}</code>、<code>{{ form.as_ul }}</code>或<code>{{ form.as_table }}</code>来渲染表单字段。</li><li>可以通过<code>{{ form.field_name }}</code>来渲染单个字段，以及<code>{{ form.field_name.errors }}</code>来显示字段的错误信息。</li></ol><h4 id=表单处理>表单处理：</h4><ol><li>在GET请求时，渲染空白表单供用户填写。</li><li>在POST请求时，根据用户提交的数据实例化表单对象。</li><li>调用表单的<code>is_valid()</code>方法进行验证，如果表单数据有效，处理数据；如果无效，返回带有错误信息的表单给用户重新填写。</li><li>在处理数据时，可以通过<code>form.cleaned_data</code>获取经过清洗后的数据，进行进一步处理。</li></ol><p>示例视图函数：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>from django.shortcuts import render
from .forms import MyForm


def my_view(request):
    if request.method == &#39;POST&#39;:
        form = MyForm(request.POST)
        if form.is_valid():
            # 处理有效的表单数据
            return render(request, &#39;success.html&#39;)
    else:
        form = MyForm()

    return render(request, &#39;my_template.html&#39;, {&#39;form&#39;: form})</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>在上面的示例中，<code>MyForm</code>是自定义的表单类，<code>my_view</code>是处理表单的视图函数，根据请求的方法渲染空白表单或处理用户提交的表单数据。</p><h2 id=第七章上下文处理><strong>第七章：上下文处理</strong></h2><h3 id=71-上下文对象的概念>7.1 上下文对象的概念</h3><p>在Django中，上下文（Context）是将数据从视图传递给模板的一种方式。它是一个字典，其中键是模板中的变量名，值是这些变量的值。视图函数通过<code>render()</code>
或<code>render_to_response()</code>方法将上下文传递给模板，模板则使用这些数据进行渲染。</p><p>在视图中，通常使用<code>context</code>参数或<code>return render(request, 'template.html', {'key': 'value', ...})</code>这样的方式来设置上下文：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>def my_view(request):
    data = {&#39;name&#39;: &#39;John&#39;, &#39;age&#39;: 30}
    return render(request, &#39;template.html&#39;, context=data)</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><h3 id=72-上下文处理器的定义和用法>7.2 上下文处理器的定义和用法</h3><p>Django的上下文处理器（Context Processors）是用于在视图无需显式设置上下文时自动添加或修改上下文的。它们是注册在Django设置中的函数，处理函数会在每次视图执行时被调用，可以修改传递给模板的默认上下文。</p><p>要定义一个上下文处理器，首先在<code>settings.py</code>中添加到<code>TEMPLATES</code>的<code>OPTIONS</code>部分的<code>context_processors</code>列表：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>TEMPLATES = [
    {
        &#39;BACKEND&#39;: &#39;django.template.backends.django.DjangoTemplates&#39;,
        &#39;APP_DIRS&#39;: True,
        &#39;OPTIONS&#39;: {
            &#39;context_processors&#39;: [
                &#39;django.template.context_processors.debug&#39;,
                &#39;django.template.context_processors.request&#39;,
                &#39;yourapp.context_processors.custom_processor&#39;,
            ],
        },
    },
]</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>然后，定义一个处理函数，例如：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>from django.conf import settings
from django.template import Context, RequestContext


def custom_processor(request):
    # 在这里添加或修改要添加到上下文的键值对
    if settings.DEBUG:
        context = {&#39;is_debug&#39;: True}
    else:
        context = {}

    # 如果需要使用RequestContext，确保添加到模板
    return RequestContext(request, context)</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>这个处理器会在每次请求时自动添加<code>is_debug</code>键到上下文，如果<code>DEBUG</code>设置为<code>True</code>。如果不需要<code>RequestContext</code>
，则直接返回<code>context</code>字典。</p><h2 id=第八章中间件><strong>第八章：中间件</strong></h2><h3 id=81-中间件的概念和作用>8.1 中间件的概念和作用</h3><p>中间件（Middleware）是Django框架中一种插件式的机制，用于在处理视图函数前后对请求和响应进行预处理和后处理。中间件可以在请求到达视图函数之前对请求进行处理，也可以在视图函数处理完响应后对响应进行处理。</p><p>中间件的作用包括但不限于：</p><ul><li>在处理请求前进行身份验证、权限检查等操作。</li><li>在处理响应前对数据进行处理，如压缩、加密等。</li><li>记录请求日志、性能监控等。</li><li>在异常处理中对错误进行处理或重定向。</li></ul><h3 id=82-中间件的实现和应用>8.2 中间件的实现和应用</h3><p>要编写和注册中间件，首先需要创建一个中间件类，实现<code>process_request</code>（处理请求前）、<code>process_view</code>
（处理视图前）、<code>process_response</code>（处理响应后）等方法中的一个或多个。</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>class CustomMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        # 在处理请求前的逻辑
        response = self.get_response(request)
        # 在处理响应后的逻辑
        return response</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>然后，在<code>settings.py</code>中的<code>MIDDLEWARE</code>设置中注册中间件类：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
    &#39;yourapp.middleware.CustomMiddleware&#39;,
]</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>中间件在请求-响应处理中的应用场景包括：</p><ul><li>认证和授权：在请求到达视图前进行用户身份验证和权限检查。</li><li>日志记录：记录请求信息、响应时间等用于监控和分析。</li><li>异常处理：捕获异常并返回自定义错误页面或信息。</li><li>缓存控制：在响应中添加缓存控制头。</li><li>响应处理：对响应进行处理，如添加额外的数据或修改响应内容。</li><li>安全控制：在请求到达前进行安全检查，如跨站请求伪造（CSRF）保护等。</li></ul><h2 id=第九章异常处理><strong>第九章：异常处理</strong></h2><h3 id=91-异常的分类和处理>9.1 异常的分类和处理</h3><p>在Django中，异常通常分为两类：系统异常（由Django框架抛出）和自定义异常（由开发者定义）。系统异常是由Django框架在执行过程中遇到的错误，例如<code>Http404</code>
和<code>PermissionDenied</code>。自定义异常通常用于表示应用的业务逻辑错误。</p><h4 id=捕获和处理异常>捕获和处理异常</h4><p>在Django中，异常处理通常通过视图函数中的<code>try-except</code>块来完成。系统异常可以通过Django的异常处理机制自动捕获和处理，而自定义异常需要开发者自己捕获并处理。</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang>from django.http import HttpResponse
from django.views.generic import View


class MyView(View):
    def get(self, request, *args, **kwargs):
        try:
            # 视图逻辑
            pass
        except SystemExit as e:
            # 系统退出异常处理
            return HttpResponse(&#34;SystemExit: &#34; &#43; str(e))
        except Exception as e:
            # 其他异常处理
            return HttpResponse(&#34;Exception: &#34; &#43; str(e))</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><h4 id=设置异常处理器>设置异常处理器</h4><p>Django默认提供了一个异常处理器<code>django.views.exception.handler</code>
，它会在视图函数中发生异常时被调用。开发者可以通过设置<code>settings.py</code>中的<code>EXCEPTION_HANDLER</code>来自定义异常处理器。</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang># settings.py

EXCEPTION_HANDLER = &#39;yourapp.utils.custom_exception_handler&#39;</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>在<code>yourapp/utils.py</code>中定义自定义异常处理器：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang># utils.py

from django.http import HttpResponse
from django.views.exception import handler


def custom_exception_handler(exc, context):
    # 获取默认的异常处理器结果
    response = handler(exc, context)

    # 自定义处理逻辑
    if response is not None:
        response.content = &#34;Custom Exception Content&#34;

    return response</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><h3 id=92-自定义异常处理>9.2 自定义异常处理</h3><p>自定义异常处理可以让开发者根据特定的业务需求来处理异常。在Django中，自定义异常通常继承自<code>django.core.exceptions.AppException</code>
或直接继承自<code>Exception</code>。</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang># yourapp/exceptions.py

class CustomException(Exception):
    pass</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>在视图函数中使用自定义异常：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang># views.py

from django.http import HttpResponse
from .exceptions import CustomException
from django.views.generic import View


class MyView(View):
    def get(self, request, *args, **kwargs):
        raise CustomException(&#34;This is a custom exception&#34;)</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>在异常处理器中捕获并处理自定义异常：</p><div class=highlight-wrapper><div class=highlight><pre class=chroma><code class=language- data-lang># utils.py

from django.http import HttpResponse
from django.views.exception import handler
from .exceptions import CustomException


def custom_exception_handler(exc, context):
    if isinstance(exc, CustomException):
        # 自定义异常处理逻辑
        return HttpResponse(&#34;Custom Exception Handled&#34;)

    response = handler(exc, context)
    return response</code></pre></div></div><script>function copyCodeToClipboard(e){const t=e.parentElement.parentElement.querySelector("pre"),n=t.textContent;navigator.clipboard.writeText(n).then(function(){const t=e.querySelector(".copy-icon"),n=e.querySelector(".check-icon");t.style.display="none",n.style.display="inline-block",setTimeout(function(){t.style.display="inline-block",n.style.display="none"},2e3)},function(){console.error("复制失败!")})}</script><style>.highlight-wrapper{position:relative;margin:1.5rem 0}.copy-code-button-container{position:absolute;top:5px;right:5px;display:flex;align-items:center;opacity:.7;transition:opacity .2s}.highlight-wrapper:hover .copy-code-button-container{opacity:1}.language-name{font-size:.8rem;color:#718096;margin-right:.5rem}.copy-code-button{background-color:transparent;border:none;color:#718096;cursor:pointer;padding:4px;border-radius:4px}.copy-code-button:hover{background-color:rgba(203,213,224,.2);color:#4a5568}.dark .language-name,.dark .copy-code-button{color:#a0aec0}.dark .copy-code-button:hover{background-color:rgba(160,174,192,.2);color:#e2e8f0}</style><p>通过这种方式，开发者可以更好地控制异常的处理流程，提高应用的稳定性和用户体验。</p><h2 id=附录adjango最佳实践><strong>附录A：Django最佳实践</strong></h2><p>AD: <a href=https://cmdragon.cn/>一个覆盖广泛主题工具的高效在线平台(cmdragon.cn)</a></p><ol><li><p><strong>代码规范</strong>：</p><ul><li><strong>命名约定</strong>：遵循PEP8（Python编码风格指南），如模型类名以<code>CamelCase</code>命名，函数名以<code>snake_case</code>命名。</li><li><strong>分模块</strong>：将代码划分为逻辑清晰的模块，如<code>views.py</code>,<code>models.py</code>,<code>forms.py</code>等。</li><li><strong>Django模板</strong>：使用模板继承和模板标签提高复用性和可维护性。</li></ul></li></ol><p>AD: <a href=https://comic.cmdragon.cn:2087/>漫画首页</a></p><ol><li><p><strong>性能优化</strong>：</p><ul><li><strong>查询优化</strong>：使用<code>select_related</code>和<code>prefetch_related</code>减少数据库查询次数。</li><li><strong>缓存</strong>：使用<code>django.core.cache</code>或第三方缓存库（如Memcached或Redis）。</li><li><strong>分页</strong>：对于大量数据，使用分页功能，限制每页显示的数据量。</li><li><strong>静态文件处理</strong>：将静态文件（如CSS, JS, 图片）托管在CDN或使用<code>collectstatic</code>命令。</li></ul></li></ol><p>AD: <a href=https://movie.cmdragon.cn:2083/>专业的搜索引擎</a></p><ol><li><p><strong>安全防范</strong>：</p><ul><li><strong>CSRF保护</strong>：确保启用了CSRF保护，使用<code>{% csrf_token %}</code>标签。</li><li><strong>密码安全</strong>：使用<code>get_password_hash</code>和<code>check_password</code>处理用户密码。</li><li><strong>输入验证</strong>：对用户输入进行验证，使用Django的<code>ModelForm</code>和<code>forms</code>模块。</li><li><strong>XSS和SQL注入防护</strong>：使用<code>safe</code>和<code>escape</code>模板过滤器，以及<code>django.middleware.csrf.CsrfViewMiddleware</code>。</li></ul></li><li><p><strong>可维护性</strong>：</p><ul><li><strong>文档</strong>：为代码编写清晰的注释，使用<code>django.contrib.comments</code>或自定义评论系统。</li><li><strong>代码审查</strong>：定期进行代码审查，遵循DRY（Don&rsquo;t Repeat Yourself）原则。</li><li><strong>错误处理</strong>：使用<code>try/except</code>处理可能的错误，提供有用的错误消息。</li></ul></li><li><p><strong>部署</strong>：</p><ul><li><strong>设置环境变量</strong>：使用环境变量管理配置，如<code>DJANGO_SETTINGS_MODULE</code>。</li><li><strong>使用部署工具</strong>：如Gunicorn, uWSGI, Nginx等。</li><li><strong>日志记录</strong>：启用详细的日志记录，使用<code>logging</code>模块。</li></ul></li><li><p><strong>持续集成/持续部署（CI/CD）</strong> ：使用工具如Jenkins, Travis CI或GitHub Actions自动化构建和部署过程。</p></li></ol><p>遵循这些最佳实践可以帮助你开发出更加健壮、高效和安全的Django应用。</p></div><div class="border-t border-gray-200 dark:border-gray-700 pt-6 mt-8"><h2 class="text-lg font-medium mb-4 flex items-center"><div class="bg-gradient-to-br from-blue-500 to-indigo-600 p-1.5 rounded text-white mr-2"><iconify-icon icon=mdi:tag-multiple width=16 height=16></iconify-icon></div>标签</h2><div class="flex flex-wrap gap-2"><a href=/tags/Django class="bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-full text-sm hover:bg-blue-600 hover:text-white dark:hover:bg-blue-600 dark:hover:text-white transition-colors duration-200" aria-label="标签: Django" tabindex=0><iconify-icon icon=mdi:tag class=mr-1 inline></iconify-icon>Django
</a><a href=/tags/%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86 class="bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-full text-sm hover:bg-blue-600 hover:text-white dark:hover:bg-blue-600 dark:hover:text-white transition-colors duration-200" aria-label="标签: 请求处理" tabindex=0><iconify-icon icon=mdi:tag class=mr-1 inline></iconify-icon>请求处理
</a><a href=/tags/%E5%93%8D%E5%BA%94%E7%94%9F%E6%88%90 class="bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-full text-sm hover:bg-blue-600 hover:text-white dark:hover:bg-blue-600 dark:hover:text-white transition-colors duration-200" aria-label="标签: 响应生成" tabindex=0><iconify-icon icon=mdi:tag class=mr-1 inline></iconify-icon>响应生成
</a><a href=/tags/%E6%A8%A1%E6%9D%BF%E6%B8%B2%E6%9F%93 class="bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-full text-sm hover:bg-blue-600 hover:text-white dark:hover:bg-blue-600 dark:hover:text-white transition-colors duration-200" aria-label="标签: 模板渲染" tabindex=0><iconify-icon icon=mdi:tag class=mr-1 inline></iconify-icon>模板渲染
</a><a href=/tags/%E8%A1%A8%E5%8D%95%E5%A4%84%E7%90%86 class="bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-full text-sm hover:bg-blue-600 hover:text-white dark:hover:bg-blue-600 dark:hover:text-white transition-colors duration-200" aria-label="标签: 表单处理" tabindex=0><iconify-icon icon=mdi:tag class=mr-1 inline></iconify-icon>表单处理
</a><a href=/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6 class="bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-full text-sm hover:bg-blue-600 hover:text-white dark:hover:bg-blue-600 dark:hover:text-white transition-colors duration-200" aria-label="标签: 中间件" tabindex=0><iconify-icon icon=mdi:tag class=mr-1 inline></iconify-icon>中间件
</a><a href=/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86 class="bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-full text-sm hover:bg-blue-600 hover:text-white dark:hover:bg-blue-600 dark:hover:text-white transition-colors duration-200" aria-label="标签: 异常处理" tabindex=0><iconify-icon icon=mdi:tag class=mr-1 inline></iconify-icon>异常处理</a></div></div><nav class="border-t border-gray-200 dark:border-gray-700 pt-6 mt-8 grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-xl transition-all hover:shadow-md duration-300"><span class="block text-sm text-gray-600 dark:text-gray-300 mb-2 flex items-center"><iconify-icon icon=mdi:arrow-left class=mr-2 width=16 height=16></iconify-icon>上一篇
</span><a href=https://blog.cmdragon.cn/posts/45f66244be583a6db133781c25b25d98/ class="font-medium text-blue-700 dark:text-blue-300 hover:text-blue-800 dark:hover:text-blue-200 block" aria-label="上一篇: 深入 Django 模型层：数据库设计与 ORM 实践指南" tabindex=0>深入 Django 模型层：数据库设计与 ORM 实践指南</a></div><div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-xl md:text-right transition-all hover:shadow-md duration-300"><span class="block text-sm text-gray-600 dark:text-gray-300 mb-2 flex items-center md:justify-end">下一篇<iconify-icon icon=mdi:arrow-right class=ml-2 width=16 height=16></iconify-icon>
</span><a href=https://blog.cmdragon.cn/posts/bea111715764852706f5ef8b2e4401e4/ class="font-medium text-blue-700 dark:text-blue-300 hover:text-blue-800 dark:hover:text-blue-200 block" aria-label="下一篇: 深入学习和理解Django模板层：构建动态页面" tabindex=0>深入学习和理解Django模板层：构建动态页面</a></div></nav><div class="border-t border-gray-200 dark:border-gray-700 pt-6 mt-8"><h2 class="text-lg font-medium mb-4 flex items-center"><div class="bg-gradient-to-br from-blue-500 to-indigo-600 p-1.5 rounded text-white mr-2"><iconify-icon icon=mdi:share-variant width=16 height=16></iconify-icon></div>分享</h2><div class="flex flex-wrap gap-3"><a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fblog.cmdragon.cn%2fposts%2f3476dd0354c04bdd0485e1bbe91ccb1b%2f&text=%e6%b7%b1%e5%85%a5%e5%ad%a6%e4%b9%a0%e5%92%8c%e7%90%86%e8%a7%a3Django%e8%a7%86%e5%9b%be%e5%b1%82%ef%bc%9a%e5%a4%84%e7%90%86%e8%af%b7%e6%b1%82%e4%b8%8e%e5%93%8d%e5%ba%94" target=_blank rel="noopener noreferrer" class="bg-gradient-to-r from-[#1DA1F2] to-[#0a6da6] text-white px-4 py-2 rounded-lg hover:shadow-md transition-all duration-300" aria-label="分享到 Twitter" tabindex=0><iconify-icon icon=mdi:twitter width=20 height=20></iconify-icon></a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.cmdragon.cn%2fposts%2f3476dd0354c04bdd0485e1bbe91ccb1b%2f" target=_blank rel="noopener noreferrer" class="bg-gradient-to-r from-[#1877F2] to-[#0a4fad] text-white px-4 py-2 rounded-lg hover:shadow-md transition-all duration-300" aria-label="分享到 Facebook" tabindex=0><iconify-icon icon=mdi:facebook width=20 height=20></iconify-icon></a><a href="https://service.weibo.com/share/share.php?url=https%3a%2f%2fblog.cmdragon.cn%2fposts%2f3476dd0354c04bdd0485e1bbe91ccb1b%2f&title=%e6%b7%b1%e5%85%a5%e5%ad%a6%e4%b9%a0%e5%92%8c%e7%90%86%e8%a7%a3Django%e8%a7%86%e5%9b%be%e5%b1%82%ef%bc%9a%e5%a4%84%e7%90%86%e8%af%b7%e6%b1%82%e4%b8%8e%e5%93%8d%e5%ba%94" target=_blank rel="noopener noreferrer" class="bg-gradient-to-r from-[#E6162D] to-[#ad0f21] text-white px-4 py-2 rounded-lg hover:shadow-md transition-all duration-300" aria-label=分享到微博 tabindex=0><iconify-icon icon=mdi:sina-weibo width=20 height=20></iconify-icon></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fblog.cmdragon.cn%2fposts%2f3476dd0354c04bdd0485e1bbe91ccb1b%2f" target=_blank rel="noopener noreferrer" class="bg-gradient-to-r from-[#0A66C2] to-[#07508f] text-white px-4 py-2 rounded-lg hover:shadow-md transition-all duration-300" aria-label="分享到 LinkedIn" tabindex=0><iconify-icon icon=mdi:linkedin width=20 height=20></iconify-icon></a></div></div></article><aside class="w-full lg:w-1/4"><button id=mobile-toc-toggle class="z-50 fixed bottom-4 right-4 z-20 lg:hidden bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-full w-12 h-12 flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
<iconify-icon icon=mdi:table-of-contents width=24 height=24></iconify-icon></button><div id=toc-container class="lg:sticky lg:top-24 bg-white dark:bg-gray-800 rounded-xl shadow-md p-5 mb-8 transition-all duration-300 border border-gray-100 dark:border-gray-700
fixed inset-y-0 right-0 w-72 z-40 lg:z-20 transform translate-x-full lg:transform-none lg:w-auto
lg:overflow-visible flex flex-col"><div class="toc-header flex justify-between items-center pb-3 border-b border-gray-100 dark:border-gray-700 lg:mb-4"><h2 class="text-lg font-medium flex items-center"><div class="bg-gradient-to-br from-blue-500 to-indigo-600 p-1.5 rounded text-white mr-2"><iconify-icon icon=mdi:table-of-contents width=16 height=16></iconify-icon></div>目录</h2><div class="flex items-center"><button id=toc-toggle class="text-gray-500 hover:text-blue-700 dark:hover:text-blue-300 transition-colors p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full" aria-label=折叠目录>
<iconify-icon id=toc-icon icon=mdi:chevron-up width=20 height=20></iconify-icon></button>
<button id=toc-close class="ml-1 lg:hidden text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full">
<iconify-icon icon=mdi:close width=20 height=20></iconify-icon></button></div></div><div id=toc-content class="toc text-sm text-gray-700 dark:text-gray-300 flex-grow overflow-y-auto"><nav id=TableOfContents><ul><li><ul><li><a href=#11-什么是django>1.1 什么是Django？</a></li><li><a href=#12-django的核心组件>1.2 Django的核心组件</a></li></ul></li><li><a href=#第二章django视图层基础><strong>第二章：Django视图层基础</strong></a><ul><li><a href=#21-视图函数的定义和作用>2.1 视图函数的定义和作用</a></li><li><a href=#22-类视图的概念和用法>2.2 类视图的概念和用法</a></li></ul></li><li><a href=#第三章处理请求><strong>第三章：处理请求</strong></a><ul><li><a href=#31-请求对象的属性和方法>3.1 请求对象的属性和方法</a></li><li><a href=#32-请求处理流程>3.2 请求处理流程</a></li></ul></li><li><a href=#第四章生成响应><strong>第四章：生成响应</strong></a><ul><li><a href=#41-响应对象的属性和方法>4.1 响应对象的属性和方法</a></li><li><a href=#42-响应处理流程>4.2 响应处理流程</a></li></ul></li><li><a href=#第五章模板渲染><strong>第五章：模板渲染</strong></a><ul><li><a href=#51-模板语言基础>5.1 模板语言基础</a></li><li><a href=#52-模板渲染流程>5.2 模板渲染流程</a></li></ul></li><li><a href=#第六章表单处理><strong>第六章：表单处理</strong></a><ul><li><a href=#61-表单定义和验证>6.1 表单定义和验证</a><ul><li><a href=#表单类定义示例>表单类定义示例：</a></li><li><a href=#表单验证过程>表单验证过程：</a></li></ul></li><li><a href=#62-表单渲染和处理>6.2 表单渲染和处理</a><ul><li><a href=#表单渲染>表单渲染：</a></li><li><a href=#表单处理>表单处理：</a></li></ul></li></ul></li><li><a href=#第七章上下文处理><strong>第七章：上下文处理</strong></a><ul><li><a href=#71-上下文对象的概念>7.1 上下文对象的概念</a></li><li><a href=#72-上下文处理器的定义和用法>7.2 上下文处理器的定义和用法</a></li></ul></li><li><a href=#第八章中间件><strong>第八章：中间件</strong></a><ul><li><a href=#81-中间件的概念和作用>8.1 中间件的概念和作用</a></li><li><a href=#82-中间件的实现和应用>8.2 中间件的实现和应用</a></li></ul></li><li><a href=#第九章异常处理><strong>第九章：异常处理</strong></a><ul><li><a href=#91-异常的分类和处理>9.1 异常的分类和处理</a><ul><li><a href=#捕获和处理异常>捕获和处理异常</a></li><li><a href=#设置异常处理器>设置异常处理器</a></li></ul></li><li><a href=#92-自定义异常处理>9.2 自定义异常处理</a></li></ul></li><li><a href=#附录adjango最佳实践><strong>附录A：Django最佳实践</strong></a></li></ul></nav></div></div><div id=toc-overlay class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden lg:hidden backdrop-blur-sm"></div></aside></div></div><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js></script><link rel=stylesheet href=/css/markdown.css><link rel=stylesheet href=/css/code-highlight.css><script src=/js/code-highlight.js></script><script src=/js/toc.js></script><script>document.addEventListener("DOMContentLoaded",function(){console.log("初始化代码高亮..."),window.hljs?(console.log("highlight.js 已加载"),document.querySelectorAll("pre code").forEach(function(e){console.log("应用高亮到代码块"),hljs.highlightElement(e)})):console.error("highlight.js 未加载!")})</script><style>#toc-content{max-height:none}@media(min-width:1024px){#toc-content{max-height:none;overflow:visible}#toc-container{max-height:calc(100vh - 120px);overflow-y:auto}nav#TableOfContents{overflow:visible}}@media(max-width:1023px){#toc-container{padding-bottom:env(safe-area-inset-bottom,20px);display:flex;flex-direction:column}#toc-content{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-bottom:20px}}</style></main><footer class="bg-gradient-to-b from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 shadow-inner py-10 mt-12 border-t border-gray-200 dark:border-gray-700"><div class="container mx-auto px-4"><div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8"><div><h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white flex items-center"><div class="bg-gradient-to-br from-blue-500 to-indigo-600 p-1.5 rounded text-white mr-2"><iconify-icon icon=mdi:information width=16 height=16></iconify-icon></div>关于本站</h3><p class="text-sm text-gray-600 dark:text-gray-400 mb-4">cmdragon's Blog 是一个专注于编程和技术分享的个性化网站，旨在为编程爱好者、学习者和从业者提供全面的前端开发、后端开发以及全栈开发学习资源。</p><div class="flex space-x-3"><a href=https://github.com/cmdragon class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-300 bg-gray-100 dark:bg-gray-700 p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600" aria-label=GitHub tabindex=0 target=_blank rel="noopener noreferrer"><iconify-icon icon=mdi:github width=18 height=18></iconify-icon></a><button id=wechat-btn class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-300 bg-gray-100 dark:bg-gray-700 p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600" aria-label=微信 tabindex=0>
<iconify-icon icon=mdi:wechat width=18 height=18></iconify-icon></button>
<a href=mailto:support@cmdragon.cn class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-300 bg-gray-100 dark:bg-gray-700 p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600" aria-label=Email tabindex=0><iconify-icon icon=mdi:email width=18 height=18></iconify-icon></a><a href=/index.xml class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-300 bg-gray-100 dark:bg-gray-700 p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600" aria-label=RSS tabindex=0><iconify-icon icon=mdi:rss width=18 height=18></iconify-icon></a></div></div><div><h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white flex items-center"><div class="bg-gradient-to-br from-blue-500 to-indigo-600 p-1.5 rounded text-white mr-2"><iconify-icon icon=mdi:link-variant width=16 height=16></iconify-icon></div>快速链接</h3><ul class=space-y-2><li><a href=https://movie.cmdragon.cn/ class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-300 flex items-center" target=_blank rel="noopener noreferrer"><iconify-icon icon=mdi:chevron-right class="mr-2 text-primary" width=16 height=16></iconify-icon>高清影视库</a></li><li><a href=https://comic.cmdragon.cn/ class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-300 flex items-center" target=_blank rel="noopener noreferrer"><iconify-icon icon=mdi:chevron-right class="mr-2 text-primary" width=16 height=16></iconify-icon>精选漫画阅读</a></li><li><a href=https://tools.cmdragon.cn/zh class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-300 flex items-center" target=_blank rel="noopener noreferrer"><iconify-icon icon=mdi:chevron-right class="mr-2 text-primary" width=16 height=16></iconify-icon>实用在线工具</a></li><li><a href=https://hot-movie.cmdragon.cn/ class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-300 flex items-center" target=_blank rel="noopener noreferrer"><iconify-icon icon=mdi:chevron-right class="mr-2 text-primary" width=16 height=16></iconify-icon>热映影视推荐</a></li></ul></div><div><h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white flex items-center"><div class="bg-gradient-to-br from-blue-500 to-indigo-600 p-1.5 rounded text-white mr-2"><iconify-icon icon=mdi:tag-multiple width=16 height=16></iconify-icon></div>热门标签</h3><div class="flex flex-wrap gap-2"><a href=https://blog.cmdragon.cn/tags/FastAPI/ class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full hover:bg-blue-700 hover:text-white transition-colors duration-300">#FastAPI <span class="text-xs opacity-70">(89)</span>
</a><a href=https://blog.cmdragon.cn/tags/Nuxt/ class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full hover:bg-blue-700 hover:text-white transition-colors duration-300">#Nuxt <span class="text-xs opacity-70">(68)</span>
</a><a href=https://blog.cmdragon.cn/tags/%E9%92%A9%E5%AD%90/ class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full hover:bg-blue-700 hover:text-white transition-colors duration-300">#钩子 <span class="text-xs opacity-70">(62)</span>
</a><a href=https://blog.cmdragon.cn/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/ class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full hover:bg-blue-700 hover:text-white transition-colors duration-300">#性能优化 <span class="text-xs opacity-70">(47)</span>
</a><a href=https://blog.cmdragon.cn/tags/Nuxt.js/ class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full hover:bg-blue-700 hover:text-white transition-colors duration-300">#Nuxt.js <span class="text-xs opacity-70">(43)</span>
</a><a href=https://blog.cmdragon.cn/tags/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/ class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full hover:bg-blue-700 hover:text-white transition-colors duration-300">#生命周期 <span class="text-xs opacity-70">(38)</span>
</a><a href=https://blog.cmdragon.cn/tags/Nuxt3/ class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full hover:bg-blue-700 hover:text-white transition-colors duration-300">#Nuxt3 <span class="text-xs opacity-70">(37)</span>
</a><a href=https://blog.cmdragon.cn/tags/%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/ class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full hover:bg-blue-700 hover:text-white transition-colors duration-300">#错误处理 <span class="text-xs opacity-70">(32)</span>
</a><a href=https://blog.cmdragon.cn/tags/%E7%BB%84%E4%BB%B6/ class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full hover:bg-blue-700 hover:text-white transition-colors duration-300">#组件 <span class="text-xs opacity-70">(29)</span>
</a><a href=https://blog.cmdragon.cn/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/ class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full hover:bg-blue-700 hover:text-white transition-colors duration-300">#数据库管理 <span class="text-xs opacity-70">(27)</span></a></div></div></div><div class="border-t border-gray-200 dark:border-gray-700 pt-6"><div class="flex flex-col md:flex-row justify-between items-center"><div class="text-center md:text-left mb-4 md:mb-0"><p class="text-sm text-gray-600 dark:text-gray-400">&copy; 2023 cmdragon's Blog. 保留所有权利.</p><p class="text-xs text-gray-500 dark:text-gray-500 mt-1">由 <a href=https://gohugo.io/ class="hover:text-primary transition-colors duration-300" target=_blank rel="noopener noreferrer">Hugo</a> 强力驱动 |
<a href=/license/ class="hover:text-primary transition-colors duration-300" aria-label="Apache 2.0 许可证" tabindex=0>Apache License 2.0</a></p></div><button id=back-to-top class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-2 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 transform hover:scale-105 flex items-center text-sm font-medium">
<iconify-icon icon=mdi:arrow-up class=mr-1 width=16 height=16></iconify-icon>返回顶部</button></div></div></div><div id=wechat-modal class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden" onclick='this.classList.add("hidden")'><div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow-xl max-w-sm w-full relative" onclick=event.stopPropagation()><button class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200" onclick='document.getElementById("wechat-modal").classList.add("hidden")'>
<iconify-icon icon=mdi:close width=20 height=20></iconify-icon></button><h4 class="text-center font-medium text-gray-800 dark:text-gray-200 mb-4">扫码关注公众号</h4><div class="flex justify-center"><img src=/images/wechat_qrcode.webp alt=微信二维码 class="w-64 h-64 object-contain"></div></div></div></footer><script>const backToTopButton=document.getElementById("back-to-top");window.addEventListener("scroll",function(){window.scrollY>300?(backToTopButton.classList.remove("opacity-0","invisible"),backToTopButton.classList.add("opacity-100","visible")):(backToTopButton.classList.add("opacity-0","invisible"),backToTopButton.classList.remove("opacity-100","visible"))}),backToTopButton.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}),document.getElementById("wechat-btn").addEventListener("click",function(){document.getElementById("wechat-modal").classList.remove("hidden")}),document.getElementById("wechat-btn").addEventListener("keydown",function(e){(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),document.getElementById("wechat-modal").classList.remove("hidden"))})</script></div><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><script src=/js/code-highlight.js></script><script src=/js/advanced-render.js></script><div id=site-search-modal class="fixed inset-0 z-50 flex items-center justify-center hidden opacity-0 transition-opacity duration-300"><div id=site-search-backdrop class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm"></div><div class="relative bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 rounded-xl shadow-xl max-w-lg w-full mx-4 z-10 transform transition-all duration-300 scale-95 opacity-0 border border-gray-100 dark:border-gray-700"><div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700"><h3 class="text-lg font-medium flex items-center"><div class="bg-gradient-to-br from-blue-500 to-indigo-600 p-1.5 rounded text-white mr-2 shadow-sm"><iconify-icon icon=mdi:magnify width=16 height=16></iconify-icon></div><span class="bg-clip-text text-transparent bg-gradient-to-r from-blue-500 to-indigo-600">站内搜索</span></h3><button id=site-search-close class="text-gray-400 hover:text-gray-500 focus:outline-none transition-colors duration-200 p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full">
<iconify-icon icon=mdi:close width=20 height=20></iconify-icon></button></div><div class=p-6><form id=site-search-form action=/search/ method=get><div class=relative><div class="flex items-center border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden focus-within:ring-2 focus-within:ring-blue-500 transition-all duration-300 shadow-sm hover:shadow-md"><span class="pl-4 text-gray-400"><iconify-icon icon=mdi:magnify width=20 height=20></iconify-icon></span><input type=text id=site-search-input name=q placeholder=输入关键词搜索... class="w-full px-3 py-3 border-none focus:outline-none bg-transparent text-gray-800 dark:text-gray-200" aria-label=搜索内容 tabindex=0>
<button type=submit class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white px-4 py-3 hover:shadow-md transition-all duration-300 flex items-center" aria-label=搜索 tabindex=0>
<span class="mr-1 hidden sm:inline">搜索</span>
<iconify-icon icon=mdi:arrow-right width=18 height=18></iconify-icon></button></div></div></form><div class="mt-6 text-sm text-gray-500 dark:text-gray-400 bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-100 dark:border-blue-800/30 flex items-start"><div class="bg-blue-100 dark:bg-blue-800/50 p-1.5 rounded-full mr-3 mt-0.5"><iconify-icon icon=mdi:information width=16 height=16 class="text-blue-500 dark:text-blue-300"></iconify-icon></div><div><p class=mb-1>快捷键提示:</p><ul class=space-y-1><li class="flex items-center"><span class="bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded text-xs font-mono mr-2">/</span>
<span>打开搜索</span></li><li class="flex items-center"><span class="bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded text-xs font-mono mr-2">Esc</span>
<span>关闭搜索</span></li><li class="flex items-center"><span class="bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded text-xs font-mono mr-2">Enter</span>
<span>提交搜索</span></li></ul></div></div><div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"><div class="flex flex-wrap gap-2"><a href=/tags/ class="bg-gradient-to-r hover:bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 text-gray-700 dark:text-gray-300 px-3 py-1.5 rounded-lg text-sm border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-700 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-md flex items-center"><iconify-icon icon=mdi:tag-multiple class=mr-1 width=16 height=16></iconify-icon>标签
</a><a href=/categories/ class="bg-gradient-to-r hover:bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 text-gray-700 dark:text-gray-300 px-3 py-1.5 rounded-lg text-sm border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-700 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-md flex items-center"><iconify-icon icon=mdi:folder-multiple class=mr-1 width=16 height=16></iconify-icon>分类
</a><a href=/archives/ class="bg-gradient-to-r hover:bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 text-gray-700 dark:text-gray-300 px-3 py-1.5 rounded-lg text-sm border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-700 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-md flex items-center"><iconify-icon icon=mdi:archive class=mr-1 width=16 height=16></iconify-icon>归档</a></div></div></div></div></div><script>document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("site-search-modal"),t=e.querySelector('div[class*="rounded-xl"]'),s=document.getElementById("site-search-backdrop"),o=document.getElementById("site-search-close"),a=document.getElementById("site-search-form"),i=document.getElementById("site-search-input");window.openSiteSearch=function(){e.classList.remove("hidden"),document.body.classList.add("overflow-hidden"),setTimeout(()=>{e.classList.add("opacity-100"),t.classList.remove("scale-95","opacity-0"),t.classList.add("scale-100","opacity-100"),i.focus()},10)};function n(){e.classList.remove("opacity-100"),t.classList.remove("scale-100","opacity-100"),t.classList.add("scale-95","opacity-0"),setTimeout(()=>{e.classList.add("hidden"),document.body.classList.remove("overflow-hidden")},300)}s&&s.addEventListener("click",n),o&&o.addEventListener("click",n),document.addEventListener("keydown",t=>{t.key==="Escape"&&!e.classList.contains("hidden")&&n(),t.key==="/"&&e.classList.contains("hidden")&&document.activeElement.tagName!=="INPUT"&&(t.preventDefault(),openSiteSearch())}),t.addEventListener("click",e=>{e.stopPropagation()})})</script></body></html>