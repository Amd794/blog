<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>异步数据库 on cmdragon's Blog</title><link>/tags/%E5%BC%82%E6%AD%A5%E6%95%B0%E6%8D%AE%E5%BA%93/</link><description>Recent content in 异步数据库 on cmdragon's Blog</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Sat, 03 May 2025 14:48:01 +0800</lastBuildDate><atom:link href="/tags/%E5%BC%82%E6%AD%A5%E6%95%B0%E6%8D%AE%E5%BA%93/index.xml" rel="self" type="application/rss+xml"/><item><title>异步数据库事务锁：电商库存扣减的防超卖秘籍</title><link>/posts/dd8b49ce80066db8c2671d365a9e9e32/</link><pubDate>Sat, 03 May 2025 14:48:01 +0800</pubDate><guid>/posts/dd8b49ce80066db8c2671d365a9e9e32/</guid><description>FastAPI框架中使用Tortoise-ORM进行异步数据库操作时，处理电商库存扣减等需要数据一致性的场景，传统同步操作会导致竞态条件。Tortoise-ORM的异步解决方案需配合事务锁机制，包括悲观锁和乐观锁。悲观锁通过&lt;code>select_for_update()&lt;/code>锁定记录，确保原子操作；乐观锁通过版本号机制实现无锁检测，采用指数退避重试策略避免活锁。高冲突率场景适合悲观锁，低冲突率场景适合乐观锁。</description></item><item><title>Tortoise-ORM与FastAPI集成：异步模型定义与实践</title><link>/posts/c41e34782be5f4aa82d189539b6ae975/</link><pubDate>Sun, 20 Apr 2025 11:38:23 +0800</pubDate><guid>/posts/c41e34782be5f4aa82d189539b6ae975/</guid><description>Tortoise-ORM通过类继承方式定义数据模型，每个模型类对应数据库中的一张表。模型字段类型与数据库类型自动映射，支持主键、唯一约束、索引等配置。模型间通过外键建立关联，支持异步查询和CRUD操作。FastAPI集成时，通过&lt;code>register_tortoise&lt;/code>初始化数据库连接，并结合Pydantic模型实现数据验证。常见错误包括字段验证失败和数据库连接超时，可通过中间件和连接池配置解决。</description></item></channel></rss>