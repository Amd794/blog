<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>事务管理 on cmdragon's Blog</title><link>https://blog.cmdragon.cn/tags/%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86/</link><description>Recent content in 事务管理 on cmdragon's Blog</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Wed, 07 May 2025 00:12:40 +0800</lastBuildDate><atom:link href="https://blog.cmdragon.cn/tags/%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86/index.xml" rel="self" type="application/rss+xml"/><item><title>点赞背后的技术大冒险：分布式事务与SAGA模式</title><link>https://blog.cmdragon.cn/posts/e586c7819314ad2cb97f35676d143adc/</link><pubDate>Wed, 07 May 2025 00:12:40 +0800</pubDate><guid>https://blog.cmdragon.cn/posts/e586c7819314ad2cb97f35676d143adc/</guid><description>在微服务架构中，点赞操作涉及多个服务的数据更新，传统数据库事务在分布式系统中失效，需采用SAGA事务模式。SAGA将事务分解为多个本地事务，通过补偿机制保证最终一致性。每个操作需定义对应的补偿操作，补偿操作需幂等，并记录事务状态和实现超时机制。代码实现包括基础模型定义、事务上下文管理器和核心业务逻辑，测试验证正常和异常流程。生产环境中建议添加事务日志、实现定时补偿任务和服务降级策略。</description></item><item><title>DDD分层设计与异步职责划分：让你的代码不再“异步”混乱</title><link>https://blog.cmdragon.cn/posts/56102650d57c260e04435fe72e541ee3/</link><pubDate>Sun, 04 May 2025 00:18:53 +0800</pubDate><guid>https://blog.cmdragon.cn/posts/56102650d57c260e04435fe72e541ee3/</guid><description>DDD分层架构将系统分为用户接口层、应用层、领域层和基础设施层，各层职责明确。领域层处理同步业务逻辑，基础设施层负责异步数据库操作，应用层协调两者。评论模块使用pydantic定义领域模型，保持业务逻辑完整性。Tortoise-ORM实现基础设施层的异步仓储操作。应用层整合领域逻辑与基础设施的异步调用，确保事务管理策略通过原子操作实现。分层调用规则强调领域对象不包含await调用，仓储接口定义在领域层，实现在基础设施层。</description></item><item><title>异步IO与Tortoise-ORM的数据库</title><link>https://blog.cmdragon.cn/posts/618edd124a0fe8340f766e276faa89fb/</link><pubDate>Tue, 29 Apr 2025 13:21:47 +0800</pubDate><guid>https://blog.cmdragon.cn/posts/618edd124a0fe8340f766e276faa89fb/</guid><description>异步IO与同步IO的核心区别在于阻塞与非阻塞模式。Tortoise-ORM通过协议层、连接池层和ORM层实现异步数据库操作，支持高效的并发处理。用户管理系统搭建中，Tortoise-ORM与FastAPI结合，实现了用户创建和查询功能，并通过Pydantic进行数据校验。异步ORM适用于高并发场景，参数化查询可防止SQL注入。最佳实践包括连接池配置、查询优化和事务管理，确保系统性能和数据一致性。</description></item><item><title>分布式事务在点赞功能中的实现</title><link>https://blog.cmdragon.cn/posts/863390c56aa08b3d8d0f89e268352f3d/</link><pubDate>Sun, 27 Apr 2025 13:01:10 +0800</pubDate><guid>https://blog.cmdragon.cn/posts/863390c56aa08b3d8d0f89e268352f3d/</guid><description>分布式事务在点赞功能中面临原子性、数据一致性和失败补偿的挑战。Tortoise-ORM提供基础事务和装饰器事务两种管理方式，确保数据一致性。点赞功能实现需防重复点赞和事务处理，采用唯一约束防止重复。跨服务事务处理使用Saga模式，按反向顺序执行补偿操作确保最终一致性。常见报错包括事务超时、唯一约束冲突和请求参数校验失败，需优化事务操作、使用upsert和详细响应模型解决。</description></item><item><title>FastAPI数据库集成与事务管理</title><link>https://blog.cmdragon.cn/posts/0df867e01706fcb9c2e16ea07671a9e4/</link><pubDate>Fri, 18 Apr 2025 00:15:34 +0800</pubDate><guid>https://blog.cmdragon.cn/posts/0df867e01706fcb9c2e16ea07671a9e4/</guid><description>FastAPI与SQLAlchemy集成指南：首先配置SQLite数据库连接，创建会话工厂和声明性基类。定义用户模型并映射表结构，使用Pydantic进行数据验证。通过依赖项获取数据库会话，实现用户创建和转账功能。事务控制通过显式开始事务和错误处理确保数据一致性。常见问题包括422验证错误、500服务器错误和完整性错误，需检查请求体、数据库连接和约束。课后Quiz解答事务回滚、SQL注入防护和并发写操作处理。</description></item><item><title>FastAPI中的依赖注入与数据库事务管理</title><link>https://blog.cmdragon.cn/posts/edd7eaa71626c5d5d95f7a07c538cfe1/</link><pubDate>Wed, 09 Apr 2025 00:10:29 +0800</pubDate><guid>https://blog.cmdragon.cn/posts/edd7eaa71626c5d5d95f7a07c538cfe1/</guid><description>文章介绍了在FastAPI中使用依赖注入和SQLAlchemy进行数据库会话封装的方法，提供了三种事务管理模式的实现：自动事务模式、手动控制模式和装饰器模式。通过代码示例展示了如何创建用户注册功能，并处理事务和错误。强调了使用参数化查询防止SQL注入攻击的重要性，并提供了常见报错的解决方案，包括检查数据库连接参数、管理会话生命周期和调整连接池设置。</description></item><item><title>事务管理与锁机制</title><link>https://blog.cmdragon.cn/posts/6881aed7e5aa53915d50985da8f2fcda/</link><pubDate>Sat, 14 Dec 2024 00:18:53 +0800</pubDate><guid>https://blog.cmdragon.cn/posts/6881aed7e5aa53915d50985da8f2fcda/</guid><description>在数据库系统中，事务管理至关重要，它确保多个数据库操作能够作为一个单一的逻辑单元来执行，从而维护数据的一致性和完整性。一个良好的事务管理系统能够解决并发操作带来的问题，如脏读、不可重复读和幻读。此外，通过使用锁机制，数据库可以控制对数据的并发访问，确保数据在被多个用户操作时的安全性和一致性。</description></item></channel></rss>